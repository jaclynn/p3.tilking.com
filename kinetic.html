<!DOCTYPE HTML>
<html>
  <head>
  	
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.7.4.min.js"></script>
    <script defer="defer">
    
      function writeMessage(message) {
        text.setText(message);
        layer.draw();
      }
      
      function changeColor(shape) {
        if (shape.colorIndex < rectColors.length-1){
        	shape.colorIndex=shape.colorIndex+1;
        } else {
        	shape.colorIndex = 0;
        }
		shape.setFill(rectColors[shape.colorIndex]);
		layer.draw();
      }
      
      var rectColors = new Array('red','green','blue', 'purple', 'yellow');
      var rectangles = new Array();
      
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 300,
        height: 300
      });

      var layer = new Kinetic.Layer();
      var rect=0;
	  for (var row=0; row<300; row+=100) {
		  for (var column=0; column<300; column +=100){
		  	console.log("rectangle ",rect, row, column);
		  	rectangles[rect] = new Kinetic.Rect({
		        x: row,
		        y: column,
		        width: 100,
		        height: 100,
		        fill: rectColors[0],
		        stroke: 'black',
		        strokeWidth: 1
		      });
			  rectangles[rect].colorIndex = 0;
			  rect++;
			  
		  }
	  }
	  
	  
	  var text = new Kinetic.Text({
        x: 10,
        y: 10,
        fontFamily: 'Calibri',
        fontSize: 12,
        text: '',
        fill: 'black'
      });
	  // Events
	  for (var rect=0; rect<9; rect++) {     
	  	rectangles[rect].on('click', function() {
        	changeColor(this);
		});
	  }  
	  
                  
      // add the shapes to the layer
      for (var rect=0; rect<9; rect++) {     
	  	layer.add(rectangles[rect]);
	  }
	  layer.add(text);
	  
      // add the layer to the stage
      stage.add(layer);
    </script>
  </body>
</html>
